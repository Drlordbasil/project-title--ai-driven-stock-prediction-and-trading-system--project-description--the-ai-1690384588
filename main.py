I have optimized the Python script by providing optimized versions of the functions. You can replace the respective functions in the original script with the updated versions for optimization.
